{% extends 'base.html.twig' %}

{% block title %}{{ product.title }} - Vice City E-Shop{% endblock %}

{% block body %}

<div class="product-detail">
    <div class="container">
        <div class="product-detail__grid">
            {# Product Gallery #}
            <div class="product-detail__gallery">
                <div class="product-detail__main-image">
                    <img src="{{ product.image }}" alt="{{ product.title }}" id="mainImage">
                </div>
                <div class="product-detail__thumbnails">
                    <div class="product-detail__thumbnails-item active">
                        <img src="{{ product.image }}" alt="{{ product.title }}">
                    </div>
                    <div class="product-detail__thumbnails-item">
                        <img src="{{ product.image }}" alt="{{ product.title }}">
                    </div>
                    <div class="product-detail__thumbnails-item">
                        <img src="{{ product.image }}" alt="{{ product.title }}">
                    </div>
                    <div class="product-detail__thumbnails-item">
                        <img src="{{ product.image }}" alt="{{ product.title }}">
                    </div>
                </div>
            </div>

            {# Product Info #}
            <div class="product-detail__info">
                <div class="product-detail__badges">
                    {% if product.badge is defined %}
                    <span>{{ product.badge }}</span>
                    {% endif %}
                    <span>{{ product.platform }}</span>
                </div>

                <h1 class="product-detail__title">{{ product.title }}</h1>

                <div class="product-detail__meta">
                    <div class="product-detail__rating">
                        <div class="product-detail__rating-stars">
                            {% for i in 1..5 %}
                            <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                                <path d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z"/>
                            </svg>
                            {% endfor %}
                        </div>
                        <span class="product-detail__rating-count">({{ product.sales }} reviews)</span>
                    </div>
                    <div class="product-detail__sales">
                        <strong>{{ product.sales }}</strong> sold
                    </div>
                </div>

                <div class="product-detail__price-box">
                    <div class="product-detail__price">
                        {% if product.oldPrice is defined %}
                        <span class="product-detail__price-old">${{ product.oldPrice }}</span>
                        {% endif %}
                        ${{ product.price }}
                    </div>
                    {% if product.oldPrice is defined %}
                    <span class="product-detail__discount">
                        {{ ((product.oldPrice - product.price) / product.oldPrice * 100)|round }}% OFF
                    </span>
                    {% endif %}
                </div>

                <p class="product-detail__description">
                    {{ product.description }}
                </p>

                <div class="product-detail__options">
                    <h3 class="product-detail__options-title">Platform</h3>
                    <div class="product-detail__options-list">
                        <button class="product-detail__options-item active">PC</button>
                        <button class="product-detail__options-item">PlayStation 5</button>
                        <button class="product-detail__options-item">Xbox Series X</button>
                    </div>
                </div>

                <div class="product-detail__features">
                    <div class="product-detail__features-item">
                        <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M8 1a2 2 0 0 1 2 2v4H6V3a2 2 0 0 1 2-2zm3 6V3a3 3 0 0 0-6 0v4a2 2 0 0 0-2 2v5a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2z"/>
                        </svg>
                        <span>Instant Delivery</span>
                    </div>
                    <div class="product-detail__features-item">
                        <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                            <path d="M10.97 4.97a.235.235 0 0 0-.02.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-1.071-1.05z"/>
                        </svg>
                        <span>Money-back Guarantee</span>
                    </div>
                    <div class="product-detail__features-item">
                        <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V4zm2-1a1 1 0 0 0-1 1v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1H2zm13 2.383-4.708 2.825L15 11.105V5.383zm-.034 6.876-5.64-3.471L8 9.583l-1.326-.795-5.64 3.47A1 1 0 0 0 2 13h12a1 1 0 0 0 .966-.741zM1 11.105l4.708-2.897L1 5.383v5.722z"/>
                        </svg>
                        <span>24/7 Support</span>
                    </div>
                    <div class="product-detail__features-item">
                        <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492zM5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0z"/>
                            <path d="M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52l-.094-.319z"/>
                        </svg>
                        <span>Official License</span>
                    </div>
                </div>

                <div class="product-detail__actions">
                    <button class="btn btn--primary btn--lg flex-1" data-add-to-cart='{{ product|json_encode }}'>
                        üõí Add to Cart
                    </button>   
                </div>
            </div>
        </div>

        {# Tabs Section #}
        <div class="product-detail__tabs">
            <div class="tabs" x-data="{ activeTab: 'description' }">
                <nav class="tabs__nav">
                    <button class="tabs__tab" :class="{ 'active': activeTab === 'description' }" @click="activeTab = 'description'">Description</button>
                    <button class="tabs__tab" :class="{ 'active': activeTab === 'specs' }" @click="activeTab = 'specs'">Specifications</button>
                    <button class="tabs__tab" :class="{ 'active': activeTab === 'reviews' }" @click="activeTab = 'reviews'">Reviews ({{ product.sales }})</button>
                </nav>

                <div class="tabs__content">
                    <div class="tabs__content-pane" :class="{ 'active': activeTab === 'description' }">
                        <h3>About This Game</h3>
                        <p>{{ product.description }}</p>
                        <p>Experience the next generation of gaming with stunning graphics, immersive gameplay, and an engaging storyline. This game pushes the boundaries of what's possible in interactive entertainment.</p>
                        <h4>Key Features:</h4>
                        <ul>
                            <li>Open-world exploration with dynamic weather systems</li>
                            <li>Deep character customization options</li>
                            <li>Engaging multiplayer modes</li>
                            <li>Regular content updates and expansions</li>
                            <li>Cross-platform play support</li>
                        </ul>
                    </div>

                    <div class="tabs__content-pane" :class="{ 'active': activeTab === 'specs' }">
                        <h3>System Requirements</h3>
                        <div class="u-grid-2col">
                            <div>
                                <h4>Minimum</h4>
                                <ul>
                                    <li><strong>OS:</strong> Windows 10 64-bit</li>
                                    <li><strong>Processor:</strong> Intel Core i5-3570K</li>
                                    <li><strong>Memory:</strong> 8 GB RAM</li>
                                    <li><strong>Graphics:</strong> NVIDIA GTX 780</li>
                                    <li><strong>Storage:</strong> 50 GB available space</li>
                                </ul>
                            </div>
                            <div>
                                <h4>Recommended</h4>
                                <ul>
                                    <li><strong>OS:</strong> Windows 11 64-bit</li>
                                    <li><strong>Processor:</strong> Intel Core i7-8700K</li>
                                    <li><strong>Memory:</strong> 16 GB RAM</li>
                                    <li><strong>Graphics:</strong> NVIDIA RTX 3070</li>
                                    <li><strong>Storage:</strong> 50 GB SSD</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="tabs__content-pane" :class="{ 'active': activeTab === 'reviews' }">
                        <div class="reviews">
                            <div class="reviews__header">
                                <div class="reviews__summary">
                                    <div class="reviews__summary-score">
                                        <div class="reviews__summary-score-value">{{ product.rating }}</div>
                                        <div class="reviews__summary-score-stars">
                                            {% for i in 1..5 %}
                                            <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                                                <path d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z"/>
                                            </svg>
                                            {% endfor %}
                                        </div>
                                        <div class="reviews__summary-score-count">{{ product.sales }} reviews</div>
                                    </div>
                                </div>
                                <button class="btn btn--primary">Write a Review</button>
                            </div>

                            {# Sample Reviews #}
                            {% for i in 1..3 %}
                            <div class="reviews__item">
                                <div class="reviews__item-header">
                                    <div class="reviews__item-user">
                                        <div class="reviews__item-user-avatar">
                                            <img src="https://i.pravatar.cc/150?img={{ i + 10 }}" alt="User">
                                        </div>
                                        <div class="reviews__item-user-info">
                                            <h4>Gamer{{ i }}</h4>
                                            <time>{{ i }} days ago</time>
                                        </div>
                                    </div>
                                    <div class="reviews__item-rating">
                                        {% for j in 1..5 %}
                                        <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                            <path d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z"/>
                                        </svg>
                                        {% endfor %}
                                    </div>
                                </div>
                                <p class="reviews__item-text">
                                    Absolutely amazing game! The graphics are stunning and the gameplay is incredibly immersive. Highly recommended for any gaming enthusiast.
                                </p>
                                <div class="reviews__item-helpful">
                                    <span>Was this helpful?</span>
                                    <button>üëç Yes ({{ i * 15 }})</button>
                                    <button>üëé No ({{ i }})</button>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>
        </div>

        {# Related Products #}
        <section class="section section-sm">
            <div class="featured-section__header">
                <h2 class="featured-section__title">You May Also Like</h2>
            </div>

            <div class="product-grid">
                {% for related in related_products|slice(0, 4) %}
                <div class="card">
                    <div class="card__image">
                        <img src="{{ related.image }}" alt="{{ related.title }}" loading="lazy">
                    </div>
                    <div class="card__content">
                        <h3 class="card__title">{{ related.title }}</h3>
                        <div class="card__price">${{ related.price }}</div>
                        <a href="{{ path('product_detail', {slug: related.slug}) }}" class="btn btn--outline btn--full mt-md">
                            View Details
                        </a>
                    </div>
                </div>
                {% endfor %}
            </div>
        </section>
    </div>
</div>

{% endblock %}
