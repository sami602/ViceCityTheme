{% extends 'base.html.twig' %}

{% block title %}Browse Games - Vice City E-Shop{% endblock %}

{% block body %}

<div class="products-page">
    <div class="products-page__header">
        <h1>Browse Games</h1>
        <p>Discover thousands of amazing games at unbeatable prices</p>
    </div>

    <div class="container">
        <div class="products-page__container">
            {# Sidebar Filters #}
            <aside class="products-page__sidebar">
                <div class="filters">
                    <div class="filters__header">
                        <h3 class="filters__title">Filters</h3>
                        <button class="filters__clear" data-clear-filters>Clear All</button>
                    </div>

                    {# Category Filter #}
                    <div class="filters__group">
                        <h4 class="filters__group-title">Categories</h4>
                        <div class="filters__group-content">
                            <div class="filters__options">
                                {% for category in filters.categories %}
                                <label class="form-checkbox">
                                    <input type="checkbox" data-filter data-filter-type="category" data-filter-value="{{ category|lower }}">
                                    <span class="form-checkbox__box"></span>
                                    <span class="form-checkbox__label">{{ category }}</span>
                                </label>
                                {% endfor %}
                            </div>
                        </div>
                    </div>

                    {# Platform Filter #}
                    <div class="filters__group">
                        <h4 class="filters__group-title">Platform</h4>
                        <div class="filters__group-content">
                            <div class="filters__options">
                                {% for platform in filters.platforms %}
                                <label class="form-checkbox">
                                    <input type="checkbox" data-filter data-filter-type="platform" data-filter-value="{{ platform }}">
                                    <span class="form-checkbox__box"></span>
                                    <span class="form-checkbox__label">{{ platform }}</span>
                                </label>
                                {% endfor %}
                            </div>
                        </div>
                    </div>

                    {# Genre Filter #}
                    <div class="filters__group">
                        <h4 class="filters__group-title">Genre</h4>
                        <div class="filters__group-content">
                            <div class="filters__tag-list">
                                {% for genre in filters.genres %}
                                <button class="filters__tag" data-filter-tag data-filter-type="genre" data-filter-value="{{ genre }}">
                                    {{ genre }}
                                </button>
                                {% endfor %}
                            </div>
                        </div>
                    </div>

                    {# Price Range #}
                    <div class="filters__group">
                        <h4 class="filters__group-title">Price Range</h4>
                        <div class="filters__group-content">
                            <div class="filters__price-inputs">
                                <input type="number" class="form-input" placeholder="Min" min="0" max="100" value="0" data-price-min>
                                <span>-</span>
                                <input type="number" class="form-input" placeholder="Max" min="0" max="100" value="100" data-price-max>
                            </div>
                        </div>
                    </div>
                </div>
            </aside>

            {# Main Content #}
            <div class="products-page__main">
                {# Toolbar #}
                <div class="products-page__toolbar">
                    <div class="products-page__results">
                        Showing <strong data-results-count>{{ products|length }}</strong> games
                    </div>

                    <div class="products-page__controls">
                        {# Search #}
                        <div class="search">
                            <input type="text" class="search__input" placeholder="Search games..." data-product-search>
                            <svg class="search__icon" width="18" height="18" fill="currentColor" viewBox="0 0 16 16">
                                <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
                            </svg>
                        </div>

                        {# Sort Dropdown #}
                        <div class="sort-dropdown">
                            <button class="sort-dropdown__toggle">
                                Sort By
                            </button>
                            <div class="sort-dropdown__menu">
                                <button class="sort-dropdown__item active" data-sort="featured">Featured</button>
                                <button class="sort-dropdown__item" data-sort="name-asc">Name (A-Z)</button>
                                <button class="sort-dropdown__item" data-sort="name-desc">Name (Z-A)</button>
                                <button class="sort-dropdown__item" data-sort="price-asc">Price: Low to High</button>
                                <button class="sort-dropdown__item" data-sort="price-desc">Price: High to Low</button>
                                <button class="sort-dropdown__item" data-sort="rating">Rating</button>
                                <button class="sort-dropdown__item" data-sort="newest">Newest</button>
                            </div>
                        </div>

                        {# View Mode Toggle #}
                        <div class="products-page__view-toggle">
                            <button class="active" data-view-mode="grid" title="Grid view">
                                <svg width="18" height="18" fill="currentColor" viewBox="0 0 16 16">
                                    <path d="M1 2.5A1.5 1.5 0 0 1 2.5 1h3A1.5 1.5 0 0 1 7 2.5v3A1.5 1.5 0 0 1 5.5 7h-3A1.5 1.5 0 0 1 1 5.5v-3zm8 0A1.5 1.5 0 0 1 10.5 1h3A1.5 1.5 0 0 1 15 2.5v3A1.5 1.5 0 0 1 13.5 7h-3A1.5 1.5 0 0 1 9 5.5v-3zm-8 8A1.5 1.5 0 0 1 2.5 9h3A1.5 1.5 0 0 1 7 10.5v3A1.5 1.5 0 0 1 5.5 15h-3A1.5 1.5 0 0 1 1 13.5v-3zm8 0A1.5 1.5 0 0 1 10.5 9h3a1.5 1.5 0 0 1 1.5 1.5v3a1.5 1.5 0 0 1-1.5 1.5h-3A1.5 1.5 0 0 1 9 13.5v-3z"/>
                                </svg>
                            </button>
                            <button data-view-mode="list" title="List view">
                                <svg width="18" height="18" fill="currentColor" viewBox="0 0 16 16">
                                    <path fill-rule="evenodd" d="M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5z"/>
                                </svg>
                            </button>
                        </div>

                        {# Mobile Filters Button #}
                        <button class="btn btn--outline btn--sm lg:d-none" data-mobile-filters-toggle>
                            Filters
                        </button>
                    </div>
                </div>

                {# Product Grid #}
                <div class="product-grid">
                    {% for product in products %}
                    <div class="card" data-product='{{ product|json_encode }}'>
                        <div class="card__image">
                            <img src="{{ product.image }}" alt="{{ product.title }}" loading="lazy">
                            {% if product.badge is defined %}
                            <span class="card__badge card__badge--{{ product.badge|lower }}">{{ product.badge }}</span>
                            {% endif %}
                        </div>
                        <div class="card__content">
                            <h3 class="card__title">{{ product.title }}</h3>
                            <p class="card__description">{{ product.description }}</p>
                            <div class="card__meta">
                                <div class="card__price">
                                    {% if product.oldPrice is defined %}
                                    <span class="card__price-old">${{ product.oldPrice }}</span>
                                    {% endif %}
                                    ${{ product.price }}
                                </div>
                                <div class="card__rating">
                                    {% for i in 1..5 %}
                                    <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                        <path d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z"/>
                                    </svg>
                                    {% endfor %}
                                </div>
                            </div>
                            <div class="card__footer">
                                <button class="btn btn--primary btn--full"
                                        data-add-to-cart='{{ product|json_encode }}'>
                                    Add to Cart
                                </button>
                                <a href="{{ path('product_detail', {slug: product.slug}) }}" class="btn btn--outline">
                                    Details
                                </a>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>

                {# Pagination (static for demo) #}
                <div class="text-center mt-3xl">
                    <div class="btn-group">
                        <button class="btn btn--outline" disabled>Previous</button>
                        <button class="btn btn--primary">1</button>
                        <button class="btn btn--outline">2</button>
                        <button class="btn btn--outline">3</button>
                        <button class="btn btn--outline">Next</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

{# Mobile Filters Modal #}
<div class="mobile-filters">
    <div class="mobile-filters__header">
        <h3 class="mobile-filters__title">Filters</h3>
        <button class="mobile-filters__close" data-close-filters>âœ•</button>
    </div>
    <div class="mobile-filters__content">
        {# Same filters as sidebar (duplicate for mobile) #}
        <div class="filters">
            <div class="filters__group">
                <h4 class="filters__group-title">Categories</h4>
                <div class="filters__group-content">
                    <div class="filters__options">
                        {% for category in filters.categories %}
                        <label class="form-checkbox">
                            <input type="checkbox" data-filter data-filter-type="category" data-filter-value="{{ category|lower }}">
                            <span class="form-checkbox__box"></span>
                            <span class="form-checkbox__label">{{ category }}</span>
                        </label>
                        {% endfor %}
                    </div>
                </div>
            </div>

            <div class="filters__group">
                <h4 class="filters__group-title">Platform</h4>
                <div class="filters__group-content">
                    <div class="filters__options">
                        {% for platform in filters.platforms %}
                        <label class="form-checkbox">
                            <input type="checkbox" data-filter data-filter-type="platform" data-filter-value="{{ platform }}">
                            <span class="form-checkbox__box"></span>
                            <span class="form-checkbox__label">{{ platform }}</span>
                        </label>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="mobile-filters__footer">
        <button class="btn btn--outline" data-clear-filters>Clear All</button>
        <button class="btn btn--primary" data-apply-filters>Apply Filters</button>
    </div>
</div>

{% endblock %}
